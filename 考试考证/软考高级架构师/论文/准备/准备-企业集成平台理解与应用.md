项目介绍：太空通用平台

​	2023年6月，公司中标太空通用平台项目，此项目是某中心为完成对多种类型的太空任务进行多型号航天航空任务与试验进行的统一管理平台，根据某种型号的航天器生成具体的任务流程，发送指令给航天器，地面会不断接受航天器状态与图形等数据，地面接受系统会将数据进行解密、清洗、去重、解析，根据不同的规范和协议得到不同的数据类型，并将数据分别发往不同部门。在本项目中，本人担任架构师岗位。本文主要根据此项目对太空任务通用管理平台的企业集成过程中数据集成、控制集成、流程集成和表示集成过程中遇到的问题进行阐述。通过解决这些问题，项目成功完成多个航天航空任务的统一规划，获得了客户、领导的一致好评，并就此项目进一步开启三期工程。

​	随着空天信息产业的不断发展，各种类型飞行器不断发往太空，世界各国竞相争夺太空控制权。我国也在太空竞争中发挥重要角色，为了更有效的对各种型号飞行器进行有效的管理。快速的巡检、试验鉴定等各种类型的航天任务，某中心决定招标太空飞行设备通用管理平台。之前的系统一般是一个项目代码完成一个项目任务，对于其他项目不具备兼容性，使得每次任务都需要重复性的修改代码，根据不用类型的协议来重构代码，这使得某中心的任务不断推迟，难以按时有效推进试验任务的完成，这成为航天产业竞争的发展瓶颈。在本地项目中，作为架构师，本人整合之前各种实验任务的经验，梳理所用到的公共组件，常用的模块，整体任务流程，结合客户的想法，确定了K8s+docker的部署方式，和微服务+微前端的开发形式。确立了平台+插件的任务执行流程。

**数据集成**

​	首先在数据集成方面，数据集成是指通过不同的技术手段将内部不同的数据源进行数据的收集、转化、存储和展示，使得数据能够在个系统共享并保持一致性，数据集成的目的就是能够使得数据在不同系统中能够统一和互通，提供可靠的决策。在本系统集成过程中，由于不同业务的特点，要对不同的数据库进行整合，例如在筹划任务的软件中，数据格式比较明确，因此决定采用关系型数据库，出于国产化信创的要求，决定采用针对航天行业的神通数据库作为关系型数据库。为了加快访问速度，同时为了对分布式架构进行管理，包括分布式缓存，分布式事务，分布式锁等，决定采用一种Nosql的内存数据库，通过调查发型redis以其优秀的访问性能和持久化机制能够满足要求。同时对于文档类型的数据，为了完成多个模块的统一管理，采用ELK作为日志存储系统。同时对于航天器任务过程中发送到地面，在解析的数据是一种时间数据，具有时间特性的数据比较方便存储在时序数据库中，通过调查，TD数据库与influxDB作为时序数据库成为比较好的选择，在软件集成过程中发现大部分软件更多采用influxDB作为时序数据库，因此决定采用influDB作为接受数据后存放的平台。

​	在数据集成过程中，需要用k8s对存储数据的软件进行统一的编排，但是通过docker容器化部署会导致软件再次启动时数据发生了丢失，为了完成数据的持久化，在k8s中PV与PVC机制可以完成此项任务。同时对于内存数据库，例如redis是存储在内存中的，通过镜像部署，单体情况下在不如直接在云服务器上部署，项目中决定采用集群+哨兵的模式来对redis处理数据能力进行增强，通过这种方式，不仅能提高并发处理能力，也能增强系统可用性。

​       在数据集成时对ELK，redis，神通数据库，influxDB全部采用了集群化管理方式，通过k8s进行统一管理，完成了数据集成，作为软件运行的基础设施。

**控制集成**

​	控制集成指的是通过集成企业不同的信息系统，协调和管理企业内各个应用系统之间的控制逻辑和操作，从而实现不同系统之间的同步、调度和监控。控制集成关注的是系统的操作控制和数据流向的引导。

​	控制集成时此项目的核心要素，主要目的是为了软件的编排启动，项目中支持多种不同协议版本类型的任务，在什么时候启动哪种类型的软件版本是需要重要考虑的方面，首先对于整体软件功能结构进行梳理分析，抽象出两种软件的启动方式，一是通过界面编排容器软件，通过界面启动；二是通过消息驱动的方式来对软件进行启动与关闭。通过调查，Apache Camel是一个基于规则的路由和调解引擎，它提供了一个基于Java对象的企业集成模式的实现，使用API来配置路由和调解规则，将其作为总线工具作为调度中心，kafka作为作为一种流式数据的消息引擎能够作为消息队列。KEDA是一种K8s的插件，支持消息队列的驱动来启动容器。通过以上三种组件设计，能够解决多种协议转化、服务容器启动、服务编排等工作。

​	在控制集成过程中，项目中也着重考虑各个容器微服务的监控，对于容器的存活状态，是否宕机等都有要求。针对此问题，项目中确定了两种方式，一种是针对容器的启动与状态，另一种是针对应用的存活状态。对于容器方面，在部署微服务集群是，k8s提供一种健康监测机制，增加此机制，当宕机或者进程运行失败会进行重启。对于应用状态而言，微服务架构采用SpringBoot作为基本框架，通过MVC分层方式建立的基本结构，在服务层提供一个Rest 接口，此接口会根据不同的应用检查其状态，如果正常则返回响应，如果状态不正常则无响应或者失败响应，通过建立这种状态检查机制对于控制集成过程中微服务应用进程监控。

**流程集成**

​	流程集成是指将企业内部不同的业务流程、操作和工作流整合成一个统一的流程，以确保各个部门或系统之间的操作能够顺畅衔接和高效运行。它关注的是企业业务过程的协调和流转。控制集成的核心目标是协调企业内多个系统的运行和行为，确保不同系统之间的操作能够根据预定的控制规则、顺序和条件进行交互。它通过提供统一的控制接口，确保各个系统可以遵循统一的控制逻辑执行任务，避免系统之间产生冲突或不一致。

​	在本系统中，想要完成一个任务，各个软件之间需要调用系统内部各个软件来集成操作完成。任务的需要相互交互来完成通信，通信包括外部通信、内部服务之间的通信、内部数据交换等等。针对软件之间的各种通信方式对软件的流程进行集成。

​	首先，项目本整体表现上是一个Web服务器外部通信，K8s中提供一种网络机制，通过Intgress方式完成外部服务网关的提供，利用Intgress+Nginx方式完成外部网络通信与负载均衡。内部服务之间要相互调用，通过梳理项目所有试验任务版本的软件，总结出软件整体上通过Rest方式进行访问，部分软件采用直接HTTPClient客户端方式直接访问另一个软件的接口与数据，另一部分采用Nacos作为服务发布中心，采用Feign进行服务访问，在本次改造中，决定采用K8s内部Service机制来代替。Service机制是一种k8s的网络机制，能通过绑定Pod容器的标签的方式绑定某一种服务，调用着只需要知道服务名称就可以直接调用其他微服务，通过这种机制能够很好的完成之前的服务注册与服务发现功能。

​	在此基础上，想要完成一个实验任务需要对流程进行集成，任务需要先筹划出具体的试验任务方案，启动任务方案后，触发指令发送软件进行发送指令，飞行器接收到任务指令后开始执行任务，中间过程会不断下发数据给地面，此时数据处理软件会启动处理，评估软件也会根据数据处理后的参数不断评判，针对评估结论，任务执行方案会决定任务执行步骤，针对此流程，在完成内部与外部网络通信的基础上，将kafka作为数据中心，数据在kafka中流转，不用的应用软件根据不同的目标监听不同的Topic，从而触发任务的执行。

**表现集成**

​	表示集成是指不同系统、应用或数据源在表达方式、数据格式和结构上的统一与协调。由于不同系统或应用通常使用不同的数据格式、协议和表示方法，表示集成的目标是消除这些差异，使得不同系统或应用之间能够无缝地交换数据和信息。

​      在本项目中，不同的软件对应不同的前端，如何集成这些前端软件成为通用平台应该考虑的问题，当前组件基本采用前后端分离的部署方式，前端采用vue框架，因此项目想要完成前端界面的可组装拆卸的目录，决定采用微前端的方式，通过分析，微前端能够显示通过访问url的方式将界面嵌入到一层的iframe中，例如阿里巴巴开源的Qian Kun框架，通过微前端架构对前端界面可以高质量的集成在一起。在集成过程中也会有部分问题，例如，跨域问题，因为微前端将多个微应用加载到同一个页面中，这些微应用可能会来自不同的域名或端口，而浏览器默认会阻止跨域请求。因此项目决定采用代理的方式来进行，通过反向代理，对软件的请求进行统一分发，使得请求会话不丢失，通过这种架构来完成请求-响应的流程。



项目通过上述的集成方式，在数据集成、流程集成、控制集成和表现集成方面进行考虑，完成了项目的交付，历时9个月完成了项目从设计到联调最后交付的整体流程，并在2024年12月和2025年1月份完成两项重大航天任务，为我国获得空天优势贡献一份力量。在技术方面，通过引入K8s，完成项目的整体改造，为后续任务提供的统一的标准，后续工作可以根据标准方便的嵌入到通用平台中。获得了客户、领导、员工的一致好评。



能：

任务筹划与生成，根据多种天基装备，地基装备的条件设定约束，从而自动规划任务。

任务指令生成，根据不同任务的格式，生成不同的指令，发送给航天器。

数据解析：接受多种天基与地基装备的数据，对数据进行解密，清晰，解析，根据数据格式得到不同的参数、图像数据等数据

评估：根据解析结果对任务的完成度，陪试资源的情况进行完整的评估。

平台资源管理

权限管理

背景：



集成：

数据集成

控制集成

流程集成

表示集成

总结：











