## 国产化中间件转化（阿里云）总览

消息中间件：kafka--》RocketMQ

关系数据库：mysql--》PolarDB-O(Oracle)

时序数据库：influxDB--》lindorm(时序引擎)

索引数据库：elasticsearch--》lindorm（索引引擎）

## 消息中间件转化

kafka转化为rocketMQ

当前问题：需要明确rocketMQ的版本（4.X与5.X版本相差比较大，而且与camle兼容性有问题）

涉及软件：

遥测监视（包括指令状态监视）、遥测数据处理、数据回放、态势后台

0、收集所涉及的topic

rocketMQ对于topic的建立比较严格，当前需要知道大兆环境中的权限要求

1、kafkaTemplate转化（难度：简单）

（1）修改配置文件

（2）修改注入bean

（3）修改bean发送的数据message，tag等

2、consumer直接消费（难度：简单）

修改注解，修改获取消息的解析方式

3、apache camel 调度消费者（难度：中等）

中间涉及apache camle的部分需要增减一个中间角色来进行消费



当前需要了解：

rocketMQ的版本

SpringBoot2.7.4  

jdk版本1.8

camle版本

rocketmq版本：



版本问题：

camel版本支持1.8的最高为3.17.0

camle引接rocketMQ的数据需要camle-rocketmq的jar报

camel-rocketmq在maven库中最低版本为3.20.0，但是要求的jdk最低版本为jdk11，无法编译

2、

```
<groupId>org.apache.rocketmq</groupId>
<artifactId>rocketmq-spring-boot-starter</artifactId>
<version>2.2.3</version>
引入的是rocket-client5.0版本
```

RocketMQ 4.x 的 `rocketmq-spring-boot-starter:2.2.3`

如果rocketMQ版本为4.0 可以使用

如果低于4.0则无法使用

camel-rocketmq 3.20.0 属于4.0系列 不过需要jdk11

## 关系数据库转化

mysql转化为polarDB，目前咨询底层应该为oracle

涉及软件：

遥测监视（包括指令状态监视）、态势后台、智能监视

1、配置文件修改

2、建立表空间

3、修改配置sql

部分语法需要修改，例如jdbc对于oracle和mysql的时间类型，文本类型等格式映射有部分差异，需要检查是否需要修改。

## 时序数据库

influxDB--》lindorm(时序引擎)

涉及软件：遥测监视

1、插入支持influxDB语法（难度：中等）

需要测试当前写的point方式插入在lindorm（tsdb）中是否支持，如果不支持需要修改

2、查询不支持influxDB语法（难度：中等）

需要修改flux方式查询为lindorm的sql方式查询

3、初始化

需要获取客户端建立库的权限，本地和环境IP加入阿里云白名单，需要获取时序引擎公网IP（或者域名）与端口、用户、密码等信息

## 索引数据库

elasticsearch--》lindorm（索引引擎）

涉及软件：遥测监视、智能监视

当前lindorm中内置索引引擎为elasticsearch，查询语法兼容

可能修改点：

明确当前航天云环境中lindorm版本（或者es版本），由于es版本不太，代码编写方式有差异，需要版本兼容性修改（难度不明确）

需要获取lindorm的用户、密码、设置开发环境和本地环境的白名单