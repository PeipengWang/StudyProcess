workleave：请假

worktime：节假日

workrecord：打卡时间

CREATE TABLE `workrecord`  (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
  `cardid` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
  `cardno` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
  `idnumber` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
  `sex` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
  `cardTime` varchar(60) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
  `location` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
  PRIMARY KEY (`ID`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 589439 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Dynamic;

导入指令：readExcel.do



.system.dictionaries.impl.DictionariesService.findById]: This method isn't transactional.
2025-06-03 21:07:11 -1966937 [http-nio-8080-exec-3] DEBUG   - ==>  Preparing: select NAME, NAME_EN, BIANMA, ORDER_BY, PARENT_ID, BZ, TBSNAME, WORK_TIME, BABY_START_TIME, BABY_END_TIME, DICTIONARIES_ID from SYS_DICTIONARIES where DICTIONARIES_ID = ? 
2025-06-03 21:07:11 -1966937 [http-nio-8080-exec-3] DEBUG   - ==> Parameters: 5bd1b8974851471fa41c15d1f14113ff(String)
2025-06-03 21:07:11 -1966938 [http-nio-8080-exec-3] DEBUG   - <==      Total: 1
2025-06-03 21:07:11 -1966938 [http-nio-8080-exec-3] DEBUG   - Don't need to create transaction for [com.fh.service.workmanager.impl.WorkManagerService.selectRecord]: This method isn't transactional.
2025-06-03 21:07:11 -1966939 [http-nio-8080-exec-3] DEBUG   - ==>  Preparing: select * from workrecord where username = ? and cardTime like ? order by cardTime desc 
2025-06-03 21:07:11 -1966939 [http-nio-8080-exec-3] DEBUG   - ==> Parameters: 张骏骁(String), 2025-05-23%(String)
2025-06-03 21:07:11 -1966943 [http-nio-8080-exec-3] DEBUG   - <==      Total: 0
2025-06-03 21:07:11 -1966944 [http-nio-8080-exec-3] DEBUG 



ID	int(11)	NO	PRI		auto_increment
username	varchar(255)	YES			
cardid	varchar(255)	YES			
cardno	varchar(255)	YES			
idnumber	varchar(255)	YES			
sex	varchar(255)	YES			
cardTime	varchar(60)	YES			
location	varchar(255)	YES		





|             |             |             |             |         |             |             | 员 工 刷 卡 记 录 表 |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
| ----------- | ----------- | ----------- | ----------- | ------- | ----------- | ----------- | -------------------- | -------------------------------- | ----------- | ------ | ----------- | ----------- | ----------- | ----------- | ---- | ---- | ---- | ---- | ---- | ----------- | ----------- | ----------- | ----------- | ----------- | ---- | ----------- | ----------- | ----------- | ----------- | ---- |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             |             |         |             |             |                      | 考勤日期：04-16-2025～05-15-2025 |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             |             |         |             |             |                      | 制表时间：05-16-2025 15:13:50    |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 1       |             |             |                      |                                  | 姓名：      | 韩雪   |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 2       |             |             |                      |                                  | 姓名：      | 周子琪 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 3       |             |             |                      |                                  | 姓名：      | 刘延庆 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 4       |             |             |                      |                                  | 姓名：      | 聂正   |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 5       |             |             |                      |                                  | 姓名：      | 邵庆龙 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 6       |             |             |                      |                                  | 姓名：      | 李秀芝 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 7       |             |             |                      |                                  | 姓名：      |        |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 8       |             |             |                      |                                  | 姓名：      | 王培鹏 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 9       |             |             |                      |                                  | 姓名：      | 焦刘飞 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 10      |             |             |                      |                                  | 姓名：      | 张涛涛 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 11      |             |             |                      |                                  | 姓名：      | 王焕龙 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      | 08:36 21:10 |             |             |             |      |
|             |             |             | 工号：      | 12      |             |             |                      |                                  | 姓名：      | 钱溪平 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             | 08:34 21:02 | 08:33 18:00          | 08:28 18:01                      | 08:28 19:15 |        |             | 08:32 18:03 | 08:24 18:01 | 08:17 18:53 |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 13      |             |             |                      |                                  | 姓名：      | 苏军   |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 53079   |             |             |                      |                                  | 姓名：      | 姚鼎   |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
| 08:42 21:43 | 08:25 17:58 | 08:13 20:02 | 09:06 17:14 |         | 08:08 18:01 | 08:33 21:04 |                      |                                  | 08:15 17:59 |        | 08:05 18:00 | 08:28 18:25 | 08:07 18:02 | 08:24 18:10 |      |      |      |      |      | 08:23 18:56 | 08:02 18:02 | 08:09 20:28 | 08:19 18:04 |             |      | 08:07 18:05 | 08:33 18:00 | 08:14 18:19 | 08:12 21:03 |      |
|             | 21:52       |             |             |         |             |             |                      |                                  |             |        | 19:17       |             |             |             |      |      |      |      |      |             | 20:26       |             |             |             |      | 21:10       |             |             |             |      |
|             |             |             | 工号：      | 200411  |             |             |                      |                                  | 姓名：      | 李庚睿 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             | 10:33 17:14 |         | 08:08 18:05 | 09:00 21:04 |                      |                                  | 08:18 19:18 |        | 08:52 19:03 | 08:51 18:05 | 08:08 19:32 | 08:19 18:53 |      |      |      |      |      | 08:23 18:56 | 08:46 18:01 | 08:17 18:05 | 08:50 18:04 |             |      | 08:17 18:07 | 08:15 18:00 | 08:30 18:03 |             |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             | 20:27       | 20:31       |             |             |      | 21:11       |             |             |             |      |
|             |             |             | 工号：      | 608026  |             |             |                      |                                  | 姓名：      | 孙庆港 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 608028  |             |             |                      |                                  | 姓名：      | 曹源   |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 608036  |             |             |                      |                                  | 姓名：      | 王帅   |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 608048  |             |             |                      |                                  | 姓名：      | 李栋   |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             | 工号：      | 1026069 |             |             |                      |                                  | 姓名：      | 姚超   |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
| 08:31 21:34 | 08:14 17:58 | 08:02 16:08 |             |         | 13:05 18:00 | 08:34 17:02 | 08:33 18:00          | 08:35 18:01                      | 08:35 19:15 |        | 08:11 18:00 | 08:00 18:03 | 08:00 17:37 |             |      |      |      |      |      |             | 08:00 18:02 | 08:08 18:05 | 08:05 18:04 | 09:38 15:08 |      | 08:00 18:07 | 08:07 20:03 | 08:30 18:04 | 08:04 21:03 |      |
|             | 21:41       |             |             |         |             | 21:01       |                      |                                  |             |        | 20:30       | 21:15       |             |             |      |      |      |      |      |             | 20:27       | 20:28       |             | 17:23       |      | 21:10       |             | 20:49       |             |      |
|             |             |             | 工号：      | 1026076 |             |             |                      |                                  | 姓名：      | 朱肖肖 |             |             |             |             |      |      |      |      |      |             | 部门：      | 西安分组    |             |             |      |             |             |             |             |      |
| 16          | 17          | 18          | 19          | 20      | 21          | 22          | 23                   | 24                               | 25          | 26     | 27          | 28          | 29          | 30          | 1    | 2    | 3    | 4    | 5    | 6           | 7           | 8           | 9           | 10          | 11   | 12          | 13          | 14          | 15          |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |
|             |             |             |             |         |             |             |                      |                                  |             |        |             |             |             |             |      |      |      |      |      |             |             |             |             |             |      |             |             |             |             |      |

​	

1、搜索前四行，找到“考勤时间：”为开头的数据，截取其中的日期，获取当前表格的考勤月和天数

2、继续搜索下一行，读取到包含"姓名："的表格，表格的下一个列为姓名，将姓名保存，读取到“工号：”的下一列表格为工号，进行保存

3、下一列为当前员工的打卡时间，如果时空则不处理，如果有时间则将时间保存，注意从第一列开始，每一列代表一套

4、打卡时间可能在多个行，如果当前行数据包含姓名和工号则当前员工的考勤数据已经统计完成，可以进行下一个员工的统计

select NAME, NAME_EN, BIANMA, ORDER_BY, PARENT_ID, BZ, TBSNAME, WORK_TIME, BABY_START_TIME, BABY_END_TIME, DICTIONARIES_ID from SYS_DICTIONARIES where bz like ? order by BIANMA 

select NAME, NAME_EN, BIANMA, ORDER_BY, PARENT_ID, BZ, TBSNAME, WORK_TIME, BABY_START_TIME, BABY_END_TIME, DICTIONARIES_ID from SYS_DICTIONARIES where PARENT_ID = ? order by ORDER_BY 

select USER_ID, USERNAME, PASSWORD, NAME, RIGHTS, ROLE_ID, LAST_LOGIN, IP, STATUS, BZ, SKIN, EMAIL, NUMBER, PHONE from SYS_USER where USERNAME = ?